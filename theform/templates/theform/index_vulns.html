{% extends "theform/base.html" %}
{% block content %}


<div ng-app="myApp" ng-controller="myCtrl">

    <nav class="col-sm-2" id="myScrollspy">
        <ul class="nav nav-pills nav-stacked vertical-menu" data-offset-top="205">

            {% verbatim %}
            <li ng-repeat="x in myWelcome"><a data-toggle="pill" href="#{{ x.v_ids }}">{{ x.v_ids }}</a></li>
            {% endverbatim %}
        </ul>
    </nav>


    <form name="form" id="form">
        <button id="button" ng-click="SendData()">Submit</button><br />

        <div class="col-sm-10">
            <div class="tab-content">
                <div id="" class="active tab-pane toggle">
                    <h1 style="font-size:4em">Welcome to the Rock RMF!</h1>
                    <h1>Click on a Vulnerability item to get started.</h1>
                </div>
                {% verbatim %}


                <div ng-repeat="x in myWelcome" id="{{ x.v_ids }}" class="tab-pane toggle">
                    <div id="{{ x.v_ids }}" class="row">
                        <div class="container">
                            <!--TOP TABS MENU-->
                            <ul class="nav nav-pills">
                                <li><a class="ness" data-toggle="pill">{{ x.v_ids }}</a></li>
                                <li>
                                    <a class="ness" data-toggle="pill">
                                        <select style="color:black;" name="{{x.v_sev}}" ng-model="x.v_sev" ng-options="x for x in options">
                                            {{x}}
                                        </select><br />
                                    </a>
                                </li>
                                <li>
                                    <a class="ness" data-toggle="pill">
                                        <select style="color:black;" name="{{x.v_sta}}" ng-model="x.v_sta" ng-options="x for x in status_options">
                                            {{x}}
                                        </select><br />
                                    </a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <div style="width:100%;">
                                    <div class="half">
                                        <div class="toggle_tab">
                                            <input class="toggle_input" id="{{ x.v_ids }}_1" type="checkbox" name="tabs">
                                            <label class="toggle_label" for="{{ x.v_ids }}_1">Discussion:</label>
                                            <div class="tab-content">
                                                <p>{{ x.v_dis }}</p>
                                            </div>
                                        </div>
                                        <div class="toggle_tab">
                                            <input class="toggle_input" id="{{ x.v_ids }}_2" type="checkbox" name="tabs">
                                            <label class="toggle_label" for="{{ x.v_ids }}_2">Check Content:</label>
                                            <div class="tab-content">
                                                <p>{{ x.v_con }}</p>
                                            </div>
                                        </div>
                                        <div class="toggle_tab">
                                            <input class="toggle_input" id="{{ x.v_ids }}_3" type="checkbox" name="tabs">
                                            <label class="toggle_label" for="{{ x.v_ids }}_3">Fix Text:</label>
                                            <div class="tab-content">
                                                <p>{{ x.v_fix }}</p>
                                            </div>
                                        </div>
                                        <br />

                                        <div ng-controller="testCtrl">
                                            <h3>v_command : {{$parent.x.v_command}}</h3>
                                            <input style="width:500px;" type="text" name="{{$parent.x.v_command}}" ng-model="$parent.x.v_command" />
                                            <button id="button" ng-click="SendCommand($parent.x)">Execute</button><br />

                                            <br />
                                            <h3>title : {{title}}</h3>
                                        </div>

                                        <br />
                                        <h3>Finding Details</h3>
                                        <input style="width:500px;" type="text" name="{{x.Finding_Details}}" ng-model="x.Finding_Details" /><br />
                                        <h3>Comments</h3>
                                        <input style="width:500px;" type="text" name="{{x.Comments}}" ng-model="x.Comments" /><br />

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endverbatim %}



                <!--FORM-->
                <!--ENDFORM-->
            </div>
        </div>

    </form>
</div>
{% endblock %}



<!--
 Possibly unhandled rejection: {"data":null,"status":-1,"config":{"method":"PUT","transformRequest":[null],"transformResponse":[null],"jsonpCallbackParam":"callback","url":"/theform/vuln/112/",
"data":{"v_ids":"V-63599","v_sev":"low","v_sta":"Not_Reviewed",

"v_dis":"Credential Guard uses virtualization based security to protect information that could be used in credential theft attacks if compromised. This authentication information, which was stored in the Local Security Authority (LSA) in previous versions of Windows, is isolated from the rest of operating system and can only be accessed by privileged system software.",

"v_con":"Confirm Credential Guard is running on domain-joined systems.\n\nFor standalone systems, this is NA.\n\nFor those devices that support Credential Guard, this feature must be enabled. For devices that do not support it, there is currently an enterprise risk acceptance in effect, thus this check is currently categorized as a CAT III. Organizations need to take the appropriate action to acquire and implement compatible hardware with Credential Guard enabled.\n\nVirtualization based security, including Credential Guard, currently cannot be implemented in virtual desktop implementations (VDI) due to specific supporting requirements including a TPM, UEFI with Secure Boot, and the capability to run the Hyper-V feature within the virtual desktop.\n\nFor VDIs where the virtual desktop instance is deleted or refreshed upon logoff, this is NA.\n\nRun \"PowerShell\" with elevated privileges (run as administrator).\nEnter the following:\n\"Get-CimInstance -ClassName Win32_DeviceGuard -Namespace root\\Microsoft\\Windows\\DeviceGuard\"\n\nIf \"SecurityServicesRunning\" does not include a value of \"1\" (e.g., \"{1, 2}\"), this is a finding.\n\nAlternately:\n\nRun \"System Information\".\nUnder \"System Summary\", verify the following:\nIf \"Device Guard Security Services Running\" does not list \"Credential Guard\", this is finding.\n\nThe policy settings referenced in the Fix section will configure the following registry value. However due to hardware requirements, the registry value alone does not ensure proper function.\n\nRegistry Hive: HKEY_LOCAL_MACHINE\nRegistry Path: \\SOFTWARE\\Policies\\Microsoft\\Windows\\DeviceGuard\\\n\nValue Name: LsaCfgFlags\nValue Type: REG_DWORD\nValue: 0x00000001 (1) (Enabled with UEFI lock), or 0x00000002 (2) (Enabled without lock)\n\nA Microsoft TechNet article on Credential Guard, including system requirement details, can be found at the following link:\n\nhttps://technet.microsoft.com/itpro/windows/keep-secure/credential-guard",

"v_fix":"Virtualization based security, including Credential Guard, currently cannot be implemented in virtual desktop implementations (VDI) due to specific supporting requirements including a TPM, UEFI with Secure Boot, and the capability to run the Hyper-V feature within the virtual desktop.\n\nFor VDIs where the virtual desktop instance is deleted or refreshed upon logoff, this is NA.\n\nFor VDIs with persistent desktops this may be downgraded to a CAT II only where administrators have specific tokens for the VDI. Administrator accounts on virtual desktops must only be used on systems in the VDI; they may not have administrative privileges on any other systems such as servers and physical workstations.\n\nConfigure the policy value for Computer Configuration >> Administrative Templates >> System >> Device Guard >> \"Turn On Virtualization Based Security\" to \"Enabled\" with \"Enabled with UEFI lock\" or \"Enabled without lock\" selected for \"Credential Guard Configuration:\".\n\n\"Enabled with UEFI lock\" is preferred as more secure, however it cannot be turned off remotely through a group policy change if there is an issue.\n\n\"Enabled without lock\" will allow this to be turned off remotely while testing for issues.\n\nA Microsoft TechNet article on Credential Guard, including system requirement details, can be found at the following link:\n\nhttps://technet.microsoft.com/itpro/windows/keep-secure/credential-guard",

"v_command":"NONE",
"v_command_status":"NONE",
"v_command_enabled":"NONE",

"Comments":"NO DATA",
"Finding_Details":"NONE",
"id":112},
"headers":{"Content-Type":"application/json","Accept":"application/json, 
    text/plain, */*","X-CSRFToken":"qMqGOO49uCUsyepKK8eudQLOOAE76sIzlHcbzdlivtAh3FbD1fbCHEmFWw6kNJYS"}},"statusText":""}
-->